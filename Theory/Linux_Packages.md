# Linux_Packages

---

## –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã APT

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ó–∞—á–µ–º |
| --- | --- | --- |
| `sudo apt update` | –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤ | –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π |
| `sudo apt upgrade` | –û–±–Ω–æ–≤–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ |
| `sudo apt-get -s upgrade` | –°–∏–º—É–ª—è—Ü–∏—è | ¬´–°—É—Ö–æ–π –ø—Ä–æ–≥–æ–Ω¬ª –ø–µ—Ä–µ–¥ –∞–ø–¥–µ–π—Ç–æ–º |
| `sudo apt full-upgrade` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ä—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ | –ö–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å |
| `sudo apt install nginx` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç |  |
| `sudo apt install --reinstall nginx` | –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ | –õ–µ—á–∏—Ç –ø–æ–ª–æ–º–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã |
| `sudo apt install ./pkg.deb` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ .deb | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| `sudo apt remove nginx` | –£–¥–∞–ª–∏—Ç—å –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥–æ–≤ | ¬´—á–∏—Å—Ç–æ–µ¬ª —É–¥–∞–ª–µ–Ω–∏–µ |
| `sudo apt purge nginx` | –£–¥–∞–ª–∏—Ç—å —Å –∫–æ–Ω—Ñ–∏–≥–∞–º–∏ | –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞—Ç—å |
| `sudo apt autoremove` | –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | –ß–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã |
| `apt list --installed` | –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö | –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è |
| `apt list --upgradable` | –ö–∞–∫–∏–µ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å | –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π |
| `sudo apt-mark hold nginx` / `unhold` | –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å/—Ä–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å –≤–µ—Ä—Å–∏—é | –ß—Ç–æ–±—ã –∞–ø–≥—Ä–µ–π–¥—ã –Ω–µ —Å–Ω–æ—Å–∏–ª–∏ –Ω—É–∂–Ω–æ–µ |
| `sudo apt clean` / `autoclean` | –ß–∏—Å—Ç–∫–∞ –∫–µ—à–∞ | –û—Å–≤–æ–±–æ–¥–∏—Ç—å –º–µ—Å—Ç–æ |

---

## dpkg ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–ª–æ–π

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ó–∞—á–µ–º |
| --- | --- | --- |
| `dpkg -i file.deb` | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π `.deb` | –ë–µ–∑ apt |
| `dpkg -r pkg` | –£–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç –±–µ–∑ –∫–æ–Ω—Ñ–∏–≥–æ–≤ |  |
| `dpkg -P pkg` | –£–¥–∞–ª–∏—Ç—å —Å –∫–æ–Ω—Ñ–∏–≥–∞–º–∏ | –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |
| `dpkg -L pkg` | –§–∞–π–ª—ã –≤ –ø–∞–∫–µ—Ç–µ | –ì–¥–µ –ª–µ–∂–∏—Ç –±–∏–Ω–∞—Ä—å |
| `dpkg -S /path/file` | –ö–∞–∫–æ–π –ø–∞–∫–µ—Ç –≤–ª–∞–¥–µ–µ—Ç —Ñ–∞–π–ª–æ–º | –ü–æ–∏—Å–∫ –≤–ª–∞–¥–µ–ª—å—Ü–∞ |
| `dpkg -s pkg` | –ò–Ω—Ñ–æ –æ –ø–∞–∫–µ—Ç–µ | –í–µ—Ä—Å–∏—è, —Å—Ç–∞—Ç—É—Å |
| `dpkg -l 'nginx*‚Äô` | C–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö, –ø–æ –º–∞—Å–∫–µ |  |
| `dpkg -I file.deb` | –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –ø–æ–ª—è  | metadata |
| `dpkg -c file.deb` | –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤–Ω—É—Ç—Ä–∏ `.deb` |  |

---

## –ü–æ–∏—Å–∫ –ø–∞–∫–µ—Ç–æ–≤

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
| --- | --- |
| `apt search nginx` | –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç –ø–æ –∏–º–µ–Ω–∏/–æ–ø–∏—Å–∞–Ω–∏—é |
| `apt show nginx` | –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–∞ (–æ–ø–∏—Å–∞–Ω–∏–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏) |
| `apt-cache depends nginx` | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| `apt-cache rdepends nginx` | –û–±—Ä–∞—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–∫—Ç–æ –∑–∞–≤–∏—Å–∏—Ç) |
| `apt policy nginx` | –í–µ—Ä—Å–∏—è + —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ |
| `apt list -a nginx` | –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ |
| `apt-file search bin/foo` | –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ñ–∞–π–ª |
| `apt-cache madison nginx` | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Ä—Å–∏–π/—Ä–µ–ø–æ |
| `sudo apt-mark hold nginx` / `unhold` | –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å/—Ä–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å –≤–µ—Ä—Å–∏—é |

## –°–∫—Ä–∏–ø—Ç–∞–º ‚Äî `apt-get`, –ª—é–¥—è–º ‚Äî `apt`

- `apt` = —É–¥–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è/–ø—Ä–æ–≥—Ä–µ—Å—Å, –¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
- `apt-get`/`apt-cache` = —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤/CI.

`apt-file` —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
sudo apt install apt-file && sudo apt-file update
```

---

## –†–∞–±–æ—Ç–∞ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏

- –§–∞–π–ª—ã —Å–ø–∏—Å–∫–æ–≤: `/etc/apt/sources.list` –∏ `/etc/apt/sources.list.d/*.list` ; `/etc/apt/sources.list.d/*.sources`
- –ö–ª—é—á–∏: `/etc/apt/keyrings/*.gpg`

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
sudo add-apt-repository -y ppa:nginx/stable
sudo apt update

# –£–¥–∞–ª–∏—Ç—å PPA –∏ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Ubuntu:
sudo apt install -y ppa-purge
sudo ppa-purge ppa:nginx/stable
```

---

## Hold / Pinning

–ó–∞–ø—Ä–µ—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
sudo apt-mark hold nginx
sudo apt-mark unhold nginx
```

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (`/etc/apt/preferences.d/*.pref`):

```bash
sudo tee /etc/apt/preferences.d/nginx-1.24.pref >/dev/null <<'PIN'
Package: nginx
Pin: version 1.24.*
Pin-Priority: 1001
PIN

sudo apt update
apt-cache policy nginx
```

---

## Unattended upgrades

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

```bash
sudo apt install unattended-upgrades
sudo dpkg-reconfigure --priority=low unattended-upgrades
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏: `/etc/apt/apt.conf.d/50unattended-upgrades`

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–π–º–µ—Ä:

```bash
systemctl status apt-daily.timer apt-daily-upgrade.timer
systemctl list-timers | grep -E 'apt-daily|apt-daily-upgrade'
```

–§–∞–π–ª `/etc/apt/apt.conf.d/20auto-upgrades` ‚Äî –ø–µ—Ä–∏–æ–¥–∏–∫–∞ (–≤–∫–ª—é—á–µ–Ω–æ –ª–∏ –∞–≤—Ç–æ–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ):

```bash
APT::Periodic::Update-Package-Lists "1";
APT::Periodic::Unattended-Upgrade "1";
```

–°—É—Ö–æ–π –ø—Ä–æ–≥–æ–Ω:

```bash
sudo unattended-upgrade --dry-run --debug
```

---

## –ü—Ä–∞–∫—Ç–∏–∫—É–º

1. –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π `ls`:

```bash
dpkg -S $(which ls)
```

1. –ù–∞–π—Ç–∏ –ø–∞–∫–µ—Ç –ø–æ —Ñ–∞–π–ª—É:

```bash
apt-file search bin/htop
```

1. –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

```bash
sudo apt-mark hold nginx
```

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
apt list --upgradable
```

1. –°–Ω—è—Ç—å —Å–Ω–∞–ø—à–æ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤:

```bash
dpkg --get-selections > pkg.list
```

1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤:

```bash
sudo dpkg --set-selections < pkg.list
sudo apt-get dselect-upgrade
```

---

## üõ°Ô∏è Security Checklist

- –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å `apt update` –ø–µ—Ä–µ–¥ `apt install`.
- –ß–∏—Å—Ç–∏—Ç—å `apt autoremove` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.
- –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤–∫–ª—é—á–∏—Ç—å `unattended-upgrades`.
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å `apt policy` –ø–µ—Ä–µ–¥ –∞–ø–≥—Ä–µ–π–¥–æ–º ¬´–≤–∞–∂–Ω—ã—Ö¬ª –ø–∞–∫–µ—Ç–æ–≤.
- –î–µ—Ä–∂–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ `.list` —Ñ–∞–π–ª—ã –≤ `/etc/apt/sources.list.d/`.

---

## –ë—ã—Å—Ç—Ä—ã–µ –±–ª–æ–∫–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —Å—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
sudo apt update && sudo apt install pkg

# –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–∞–∫–µ—Ç–∞
apt-cache depends pkg

# –í—Å–µ, —á—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–∞–∫–µ—Ç–∞
apt-cache rdepends pkg

# –ì–¥–µ –ª–µ–∂–∏—Ç –±–∏–Ω–∞—Ä—å
dpkg -L pkg | grep bin/

# –ö–∞–∫–æ–π –ø–∞–∫–µ—Ç –≤–ª–∞–¥–µ–µ—Ç —Ñ–∞–π–ª–æ–º
dpkg -S /usr/bin/python3
```